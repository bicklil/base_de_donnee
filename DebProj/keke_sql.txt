CREATE OR REPLACE function is_there_a_moderator_already()
RETURNS TRIGGER
AS $$
	BEGIN 
    if old.Pseudo is not null then
        RETURN old;
    else
        UPDATE Utilisateur
        SET IntituleStatus = 'Moderateur';
        RETURN new;
    END IF;
    END;
$$ language plpgsql;

CREATE TRIGGER is_there_a_moderator_already
    BEFORE UPDATE
    ON SECTION
    FOR EACH ROW
    execute procedure is_there_a_moderator_already();


CREATE OR REPLACE function date_offre_valide()
RETURNS TRIGGER
AS $$
    BEGIN
    if DateButoire > DateAnnonce
        return new;
    else
        return old;
    END IF;
    END;
$$ language plpgsql;

CREATE TRIGGER date_offre_valide
    BEFORE INSERT
    ON OffreRecrutement
    FOR EACH ROW
    execute procedure date_offre_valide();
